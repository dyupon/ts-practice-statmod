\section{Фильтр для подавления шума}

Рассмотрим последовательность следующего вида: $x_n = s_n + \epsilon_n$, причем $\mathbb{E}\epsilon_n = 0,$ $\mathbb{D}\epsilon_n = \sigma^2,$ $\epsilon_i$ --- независимы. Рассмотрим следующий линейный фильтр:
\begin{equation*}
y_n = \sum_{i = -r_1}^{r_2} h_i x_i.
\end{equation*}

Предположим, что для сигнала выполняется следующее: $s_n = \sum_{i = -r_1}^{r_2} h_i s_i$. Тогда $\hat{s}_n = \sum_{i = -r_1}^{r_2} h_i x_i.$ Посчитаем дисперсию этой оценки:

\begin{equation*}
\mathbb{D}\hat{s}_n = \mathbb{D} \sum_{i = -r_1}^{r_2} h_i (s_i + \epsilon_i) = \mathbb{D} \sum_{i} h_i \epsilon_i = \sum_{i} h^2_i \sigma^2 = \sigma^2 \sum_{i} h^2_i.
\end{equation*}

Если хотим подавлять шум, то логично требовать $\sum_{i} h^2_i = ||\mathsf{h}||^2 \rightarrow \min$. Для скользящего среднего с шириной окна $M$ $\mathbb{D}\hat{s}_n = \frac{\sigma^2}{M}$, т.е. чем больше окно, тем больше подавляем шум.

Здесь, конечно, проблема в начальном предположении о том, что сигнал представим как линейный фильтр. На практике это верно лишь для константного и линейного сигналов.