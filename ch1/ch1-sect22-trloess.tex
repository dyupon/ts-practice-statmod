\section{Выделение тренда с помощью метода LOESS}

Для выделения тренда можно рассматривать не только параметрическую регрессию, но и непараметрическую (LOESS, LOWESS)

LOESS метод основан на сглаживании с помощью построения локальных (взвешенных) регрессий. Алгоритм получения значения в точке $n$ выглядит следующим образом:
\begin{enumerate}
	\item выделяем окно длины $h$ (параметр алгоритма);
	\item по точкам в радиусе $n \pm h/2$ строим регрессию (линейную/полиномиальную, это LOESS, или линейную/полиномиальную взвешенную, это LOWESS). Значение в точке $n$ предсказываем с помощью этой модели.
\end{enumerate}

Для LOWESS стандартный пример весовой функции --- трикубическая:
\begin{equation*}
W(z)=\left\{\begin{aligned}
\left(1-|z|^{3}\right)^{3} & \text { for }|z|<1 \\
0 & \text { for }|z| \geq 1
\end{aligned}\right.
\end{equation*}

Выделение тренда с помощью LOESS (ширина окна --- половина длины ряда, степень локальных регрессий --- $2$):

\begin{figure}[H]
	\center{\includegraphics[width=280pt, height=190pt]{loess.png}}
	\caption{Выделение тренда с помощью локальной регрессии}
\end{figure}

Как обычно, анализируем периодограмму остатка:

\begin{figure}[H]
	\center{\includegraphics[width=280pt, height=190pt]{specloess.png}}
	\caption{Периодограмма остатка ряда}
\end{figure}

Видим, что как и визуально на графике, так и с точки зрения периодограммы, тренд выделился хорошо.

Рассмотрим также выделение тренда с помощью фильтра Холдрика--Прескотта (Hodrick-- Prescott filter). Решается следующая оптимизационная задача: 

$$\sum_{i = 1}^{N}(\mathsf{X}_i - s_i)^2 - \lambda \sum_{i=2}^{N-2}((s_{i+1} - s_i) - (s_i - s_{i-1}))^2 \rightarrow \underset{\{s_i\}}{\min}$$

Здесь под $s_i$ подразумевается тренд. Эмпирическая рекомендация: если период составляет $p = 12$, то $\lambda = 129606$.

Результат применения:


\begin{figure}[H]
	\center{\includegraphics[width=280pt, height=190pt]{hp.png}}
	\caption{Выделение тренда с помощью HP--filter}
\end{figure}

Смотрим на периодограмму остатка: 

\begin{figure}[H]
	\center{\includegraphics[width=280pt, height=190pt]{spechp.png}}
	\caption{Выделение тренда с помощью HP--filter}
\end{figure}
